# Защита от прямого доступа к файлам
<Files "auth.php">
    Order Allow,Deny
    Allow from all
</Files>

# Защита логов
<Files "*.log">
    Order Allow,Deny
    Deny from all
</Files>

# Отключение индексации директории
Options -Indexes

# Защита от XSS
<IfModule mod_headers.c>
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Лимит размера запроса
LimitRequestBody 1024

# Блокировка подозрительных User-Agent
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTP_USER_AGENT} ^.*bot.*$ [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ^.*crawler.*$ [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ^.*spider.*$ [NC]
    RewriteRule ^auth.php$ - [F,L]
</IfModule>
